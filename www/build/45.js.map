{"version":3,"sources":["../../src/pages/driver-expense/driver-expense.module.ts","../../src/pages/driver-expense/driver-expense.ts"],"names":[],"mappings":"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","file":"45.js","sourcesContent":["import { CalendarModule } from 'ion2-calendar';\nimport { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { DriverExpensePage } from './driver-expense';\n\n@NgModule({\n  declarations: [\n    DriverExpensePage,\n  ],\n  imports: [\n    IonicPageModule.forChild(DriverExpensePage),\n    CalendarModule\n  ],\n})\nexport class DriverExpensePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/driver-expense/driver-expense.module.ts","import { Push } from '@ionic-native/push';\nimport { CodesProvider } from './../../providers/codes/codes';\nimport { RestProvider } from './../../providers/rest/rest';\nimport { Component, NgZone } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ModalController, ViewController } from 'ionic-angular';\nimport { CalendarComponentOptions } from 'ion2-calendar';\n\n\n@IonicPage()\n@Component({\n  selector: 'page-driver-expense',\n  templateUrl: 'driver-expense.html',\n})\nexport class DriverExpensePage {\n\n  shops : any = [];\n  vehicles : any = [];\n  html : any = '';\n  vehicle_id : any = '';\n  from_date : any ='';\n  to_date : any = '';\n  worker_id : any = '';\n  dateMulti: string[];\n  dt = new Date(2000,1,1);\n  displayCalendar : boolean = false;\n  dateRange: any =  { from: '', to: '' };\n  downloadURL : any = '';\n  srth_id : any = '';\n  month : any = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n  monthDays : any = [31,27,31,30,31,30,31,31,30,31,30,31];\n  yearFrom : any = 1900;\n  currentYear : any = null;\n  currentMonth : any = 0;\n  allYears : any = [];\n\n  selectedMonth : any = 0;\n\n  apiendpoint : any = '';\n  downloadendpoint : any = '';\n  isfullreport : boolean = true;\n\n  optionsMulti: CalendarComponentOptions = {\n    pickMode: 'range',\n    from:this.dt,\n    to:0,\n    showMonthPicker:true,\n    showToggleButtons:true,\n    color:'primary'\n  };\n\n  constructor(public navCtrl: NavController, public navParams: NavParams, private rest : RestProvider,\n    private codes : CodesProvider, private modalCtrl : ModalController, private viewCont : ViewController,\n    private zone : NgZone) {\n      \n      if(this.navParams.get(\"person\") != null || this.navParams.get(\"person\") != undefined) {\n        this.worker_id = this.navParams.get(\"person\")['worker_id'];\n      }\n\n      if(this.navParams.get(\"isfullreport\") != null || this.navParams.get(\"isfullreport\") != undefined) {\n        this.isfullreport = this.navParams.get(\"isfullreport\");\n      }\n\n      var json = JSON.parse(localStorage.getItem(this.codes.K_ACCOUNT_INFO));\n      this.srth_id = json[0]['srth_id'];\n\n      var currentDate = new Date();\n      this.currentMonth = this.month[currentDate.getMonth()];\n      this.currentYear = currentDate.getFullYear();\n\n      for(let i=this.currentYear;i>=this.yearFrom;i--) {\n        this.allYears.push(i);\n      }\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad ReportFullPage');\n    if(this.navParams.get('worker_type') == 'driver') {\n      this.getDrivers();  \n    } else {\n      this.getPersons();\n    }\n  }\n\n  getDrivers(){\n    var json = JSON.parse(localStorage.getItem(this.codes.K_ACCOUNT_INFO));\n    var data = {\n      \"srth_id\":json[0]['srth_id']\n    };\n\n    this.rest.post(this.codes.GET_WORKER,data ).then(resp => {\n        if(resp['_ReturnCode'] == '0'){\n          var data = resp['data'];\n          for(let i=0;i<data.length;i++) {\n            if(data[i]['worker_type'] == 'driver')\n              this.shops.push(data[i]);\n          }\n        }\n    });\n  }\n\n  getPersons(){\n    var json = JSON.parse(localStorage.getItem(this.codes.K_ACCOUNT_INFO));\n    var data = {\n      \"srth_id\":json[0]['srth_id']\n    };\n\n    this.rest.post(this.codes.GET_WORKER,data ).then(resp => {\n        if(resp['_ReturnCode'] == '0'){\n          this.shops = resp['data'];\n        }\n    });\n  }\n\n  openCalendar() {\n    this.displayCalendar = true;\n  }\n\n  generateReport() {\n    this.displayCalendar = false;\n\n    if (this.worker_id == 0)\n      this.worker_id = null;\n\n    var data = {};\n    if (this.isfullreport) {\n      data = {\n        \"worker_id\": this.worker_id,\n        \"date_from\": this.dateRange['from'],\n        \"date_to\": this.dateRange['to'],\n        \"srth_id\": this.srth_id\n      };\n    } else {\n      data = {\n        \"worker_id\": this.worker_id,\n        \"srth_id\": this.srth_id,\n        \"date_from\":this.currentYear+\"-\"+this.getMonthIndex(this.currentMonth)+\"-1\",\n        \"date_to\":this.currentYear+\"-\"+this.getMonthIndex(this.currentMonth)+\"-\"+this.monthDays[this.getMonthIndex(this.currentMonth) - 1]\n      }\n    }\n    this.rest.post(this.codes.DRIVER_EXPENSE_REPORT, data).then(resp => {\n      console.log(resp);\n      document.getElementById(\"report\").innerHTML = resp['data'];\n      this.zone.run(() => {\n        console.log(\"screen refreshed\");\n      });\n      // this.html = resp['data'];\n    })\n    this.downloadURL = this.codes.DRIVER_EXPENSE_REPORT_DOWNLOAD + \"?worker_id=\" + this.worker_id + \"&date_from=\" + this.dateRange['from'] + \"&date_to=\" + this.dateRange['to'];\n  }\n\n  getMonthIndex(monthString) {\n    for(let i=0;i<this.month.length;i++) {\n      if(this.month[i] == monthString)\n        return (i+1);\n    }\n    return 0;\n  }\n\n  dismiss(){\n    this.viewCont.dismiss();\n  }\n \n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/driver-expense/driver-expense.ts"],"sourceRoot":""}